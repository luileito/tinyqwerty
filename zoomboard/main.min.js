/*! tinyqwerty ZoomBoard keyboard 2015-03-17 */$(function(){function a(){return n.data("zoomboard")}function b(b){a().flash(b),b=b.toLowerCase(),i.register(i.event.TYPE,b),j.append(b),k.scrollTop(k[0].scrollHeight)}function c(){a().flash("&#8656;"),j.contents().last().remove()}function d(){a().flash("&#8629;");var b=j.text(),c=h.param("uid"),d=h.decode(h.param("txt"));i.register(i.event.SUBMIT,b),alert("You typed: '"+b+"'"),j.text(""),c&&d&&i.finish({uid:c,phrase:d,kbdsize:q},function(a){var b=JSON.parse(a);b.err>0?alert(b.msg):window.top.location.reload()})}function e(){if(a().flash("&#9251;"),o){var b=j.text().split(" ").pop();f(b)}j.append(n.data("zoomboard").actionKey.SPACE)}function f(a){return""===$.trim(a)?a:void p.check(a,function(a){var b=a[0];if(b.length>0)for(var c=0,d=b.length;d>c;c++){var e=b[c];p.getSuggestions(e,function(a){if(a){var b=a[0],c=j.text().replace(e,b);g(c)}})}})}function g(a){var c=a.split("");j.contents().remove();for(var d=0,e=c.length;e>d;d++)b(c[d])}var h=require("../common/url.min"),i=require("../common/log.min");i.config({excludeEvents:[i.event.ENTER,i.event.LEAVE],saveUrl:"results/save.php"});var j=$(".typed"),k=$(".typed-wrap"),l=$(".kbd-widget"),m=$(".cursor"),n=$(".container");!function(){var a=1;setInterval(function(){m.css({color:a%2===0?"black":"transparent"}),a++},700)}();var o=h.param("spell");if(o){require("jquery.spellchecker.min");var p=new $.SpellChecker(null,{lang:o,parser:"text",webservice:{path:"../common/spellservice/SpellChecker.php",driver:"PSpell"}})}var q=parseInt(h.param("size"))||150,r=l.width()/l.height(),s=q,t=q/r;l.css({width:s,height:t}),n.css({width:s,height:t/2}),k.css({width:s-2,height:t/2,"font-size":t/6}),k.click(d),$(document).on("selectstart",function(a){a.preventDefault()}),n.zoomboard({original_scale:q/1e3||.15}).on("zb_key",function(a){var f=a.key;if(f){var g=$(this).data("zoomboard").actionKey;switch(f){case g.ENTER:d();break;case g.DELETE:c();break;case g.SPACE:e();break;default:b(f)}i.register(i.event.TEXT_CHANGE,j.text())}})});